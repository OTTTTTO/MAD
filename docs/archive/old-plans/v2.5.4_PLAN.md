# v2.5.4 版本计划

**发布日期：** 2026-02-02
**开发时间：** ~10分钟

## 新增功能

### 🗑️ 一键清空讨论

**功能描述：**
- 添加"清空讨论"按钮，允许用户快速清空当前讨论的所有消息
- 保留讨论结构和参与者设置，仅清空消息记录
- 带有确认对话框，防止误操作

**实现细节：**
1. **后端API** (`orchestrator.js`)
   - 新增 `clearDiscussionMessages(discussionId)` 方法
   - 清空消息列表、重置轮次、清空冲突记录
   - 重置所有Agent状态为"等待中"
   - 保存更新后的上下文

2. **HTTP端点** (`web/server.js`)
   - 新增 `POST /api/discussion/{id}/clear` 端点
   - 调用 orchestrator 的清空方法

3. **前端UI** (`web/public/`)
   - 在控制面板添加"🗑️ 清空"按钮（红色危险按钮样式）
   - 点击时弹出确认对话框
   - 调用API并刷新消息列表和Agent状态
   - 添加 `.btn-danger` CSS样式

**用户体验：**
- 方便快速重新开始讨论
- 不需要删除整个讨论组
- 保留讨论标题和参与者配置

**安全考虑：**
- 双重确认机制
- 明确提示"此操作不可恢复"

## 技术要点

- ✅ 不破坏现有功能
- ✅ 实现简单（~50行代码）
- ✅ 用户价值高（常用操作）
- ✅ 代码清晰易维护

## 测试检查

- [ ] 按钮显示正常
- [ ] 确认对话框弹出
- [ ] 清空后消息列表为空
- [ ] Agent状态重置为"等待中"
- [ ] 讨论ID和标题保持不变
- [ ] 可以继续发送新消息

## 文件变更

1. `orchestrator.js` - 新增 `clearDiscussionMessages()` 方法
2. `web/server.js` - 新增 API 端点
3. `web/public/index.html` - 添加清空按钮
4. `web/public/app.js` - 添加事件处理和UI显示逻辑
5. `web/public/style.css` - 添加 `.btn-danger` 样式
6. `package.json` - 版本号更新为 2.5.4

## 后续优化建议

- 可考虑添加"软删除"功能（移到回收站）
- 可添加清空历史记录功能
- 可批量清空多个讨论
