# MAD v3.7.0 å®Œæ•´åŠŸèƒ½æ¸…å•

**ç‰ˆæœ¬ï¼š** v3.7.0
**å‘å¸ƒæ—¥æœŸï¼š** 2026-02-03ï¼ˆå¼€å‘ä¸­ï¼‰
**ä¸»é¢˜ï¼š** æ¦‚å¿µç»Ÿä¸€ + Token æ™ºèƒ½ç®¡ç† + æ™ºèƒ½æ ‡è®°

---

## ğŸ¯ ç‰ˆæœ¬ç›®æ ‡

### æ ¸å¿ƒä»»åŠ¡
1. âœ… **ç»Ÿä¸€æ¦‚å¿µ** - ç§»é™¤"é¡¹ç›®ç»„"æ¦‚å¿µï¼Œåªä¿ç•™"è®¨è®ºç»„"
2. âœ… **Token æ™ºèƒ½ç®¡ç†** - æ¢å¤ v3.0 æ‰¿è¯ºçš„ Token åŠŸèƒ½
3. âœ… **æ™ºèƒ½æ ‡è®°ç³»ç»Ÿ** - å®Œå–„ v3.0 çš„æ ‡è®°åŠŸèƒ½

### è®¾è®¡åŸåˆ™
- **ä¸åˆ é™¤åŠŸèƒ½** - åªåˆ é™¤é‡å¤çš„æ¦‚å¿µ
- **å‘åå…¼å®¹** - v3.6.x çš„æ•°æ®å¯æ­£å¸¸è¿ç§»
- **åŠŸèƒ½å¢å¼º** - åœ¨ä¿ç•™çš„åŸºç¡€ä¸Šå¢å¼º

---

## ğŸ“Š åŠŸèƒ½æ€»è§ˆ

| ç±»åˆ« | åŠŸèƒ½æ•° | æ–°å¢ | æ”¹è¿› | ä¿ç•™ |
|------|--------|------|------|------|
| **æ ¸å¿ƒè®¨è®º** | 8 | 2 | 3 | 3 |
| **Token ç®¡ç†** | 6 | 6 | 0 | 0 |
| **æ™ºèƒ½æ ‡è®°** | 5 | 5 | 0 | 0 |
| **æ ‡ç­¾ç³»ç»Ÿ** | 6 | 6 | 0 | 0 |
| **å½’æ¡£ç®¡ç†** | 5 | 5 | 0 | 0 |
| **å¯¼å‡ºåˆ†äº«** | 4 | 1 | 2 | 1 |
| **æœç´¢ç»Ÿè®¡** | 8 | 4 | 2 | 2 |
| **Agent åˆ†æ** | 3 | 0 | 0 | 3 |
| **è´¨é‡è¯„åˆ†** | 4 | 0 | 0 | 4 |
| **æ™ºèƒ½å»ºè®®** | 4 | 0 | 0 | 4 |
| **æ¨¡æ¿ç³»ç»Ÿ** | 5 | 0 | 0 | 5 |
| **å…¶ä»–åŠŸèƒ½** | 10 | 2 | 0 | 8 |
| **åˆè®¡** | **68** | **31** | **7** | **30** |

---

## 1ï¸âƒ£ æ ¸å¿ƒè®¨è®ºåŠŸèƒ½ï¼ˆ8 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ2 ä¸ªï¼‰

#### âœ¨ è‡ªç„¶è¯­è¨€åˆ›å»ºè®¨è®º
```javascript
await createDiscussionFromInput('æˆ‘æƒ³å†™ä¸€ç¯‡å…³äºå¾®æœåŠ¡æ¶æ„çš„ä¸“åˆ©æ–‡æ¡£')
```
**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨åˆ†æç”¨æˆ·æ„å›¾
- è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ä¸“å®¶
- è‡ªåŠ¨è®¾ç½®è®¨è®ºç±»åˆ«
- è‡ªåŠ¨åˆ›å»ºè®¨è®º

**æ™ºèƒ½åˆ†æï¼š**
- è¯†åˆ«é¢†åŸŸï¼šæ¶æ„è®¾è®¡ã€ä¸“åˆ©ç¼–å†™ã€æ–‡æ¡£åˆ›ä½œ
- æ¨èä¸“å®¶ï¼šarchitect, patent-expert, technical-writer
- è®¾ç½®ç±»åˆ«ï¼šæ–‡æ¡£ç¼–å†™

---

#### âœ¨ ç±»åˆ«ç³»ç»Ÿ
```javascript
await createDiscussion(topic, {
  category: 'éœ€æ±‚è®¨è®º' | 'åŠŸèƒ½ç ”å‘' | 'åŠŸèƒ½æµ‹è¯•' | 'æ–‡æ¡£ç¼–å†™'
})
```

**4 ç§ç±»åˆ«ï¼š**
- ğŸ“‹ **éœ€æ±‚è®¨è®º** - éœ€æ±‚åˆ†æã€è¯„å®¡
- ğŸ’» **åŠŸèƒ½ç ”å‘** - åŠŸèƒ½å¼€å‘
- ğŸ§ª **åŠŸèƒ½æµ‹è¯•** - æµ‹è¯•éªŒè¯
- ğŸ“ **æ–‡æ¡£ç¼–å†™** - æ–‡æ¡£åˆ›ä½œ

**æŒ‰ç±»åˆ«ç­›é€‰ï¼š**
```javascript
await getDiscussionsByCategory('åŠŸèƒ½ç ”å‘')
```

---

### æ”¹è¿›åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰

#### ğŸ”§ åˆ›å»ºè®¨è®ºï¼ˆå¢å¼ºï¼‰
```javascript
await createDiscussion(topic, {
  participants: [...],
  category: 'éœ€æ±‚è®¨è®º',     // ğŸ†• ç±»åˆ«
  tags: ['é«˜ä¼˜å…ˆçº§'],        // ğŸ†• æ ‡ç­¾
  priority: 'high',          // ğŸ†• ä¼˜å…ˆçº§
  description: 'æè¿°æ–‡æœ¬'     // ğŸ†• æè¿°
})
```

**æ–°å¢å‚æ•°ï¼š**
- `category` - ç±»åˆ«
- `tags` - åˆå§‹æ ‡ç­¾
- `priority` - ä¼˜å…ˆçº§
- `description` - æè¿°

---

#### ğŸ”§ Agent å‘è¨€ï¼ˆå¢å¼ºï¼‰
```javascript
await agentSpeak(discussionId, agentId, content, {
  tokens: {
    input: 1500,
    output: 800,
    total: 2300
  }
})
```

**æ–°å¢åŠŸèƒ½ï¼š**
- è‡ªåŠ¨è®°å½• Token ä½¿ç”¨é‡
- æ›´æ–°è®¨è®ºçš„ Token ç»Ÿè®¡
- æ·»åŠ åˆ° Token å†å²

---

#### ğŸ”§ åˆ—å‡ºè®¨è®ºï¼ˆå¢å¼ºï¼‰
```javascript
await listDiscussions({
  status: 'active',      // active | ended | archived
  category: 'åŠŸèƒ½ç ”å‘',  // æŒ‰ç±»åˆ«ç­›é€‰
  tags: ['å‰ç«¯'],        // æŒ‰æ ‡ç­¾ç­›é€‰
  limit: 10,
  offset: 0
})
```

**æ–°å¢ç­›é€‰ï¼š**
- æŒ‰çŠ¶æ€ç­›é€‰
- æŒ‰ç±»åˆ«ç­›é€‰
- æŒ‰æ ‡ç­¾ç­›é€‰

---

### ä¿ç•™åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰

```javascript
âœ… endDiscussion(id)          // ç»“æŸè®¨è®º
âœ… deleteDiscussion(id)       // åˆ é™¤è®¨è®º
âœ… getDiscussion(id)          // è·å–è®¨è®º
```

---

## 2ï¸âƒ£ Token æ™ºèƒ½ç®¡ç†ï¼ˆ6 ä¸ªï¼‰â­â­â­

### æ–°å¢åŠŸèƒ½ï¼ˆ6 ä¸ªï¼‰

#### ğŸ†• Token ç»Ÿè®¡
```javascript
const stats = await getTokenStats(discussionId)
```

**è¿”å›ï¼š**
```javascript
{
  total: 45000,        // æ€» Token æ•°
  input: 28000,        // è¾“å…¥ Token
  output: 17000,       // è¾“å‡º Token
  avgPerMessage: 1500  // å¹³å‡æ¯æ¡æ¶ˆæ¯
}
```

---

#### ğŸ†• Token å†å²
```javascript
const history = await getTokenHistory(discussionId, 10)
```

**è¿”å›ï¼š**
```javascript
[
  {
    timestamp: 1735857600000,
    messageId: 'msg-1',
    role: 'technical',
    tokens: { total: 2300, input: 1500, output: 800 }
  },
  ...
]
```

---

#### ğŸ†• ä¸Šä¸‹æ–‡å‹ç¼© â­â­â­
```javascript
const compressed = await getCompressedContext(discussionId, 80000)
```

**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨å‹ç¼©è¶…è¿‡é˜ˆå€¼çš„ä¸Šä¸‹æ–‡
- ä¿ç•™æœ€è¿‘ 50 æ¡æ¶ˆæ¯
- ä¿ç•™æ‰€æœ‰æ ‡è®°ï¼ˆMarkerï¼‰
- æ—©æœŸæ¶ˆæ¯å‹ç¼©ä¸ºæ‘˜è¦

**è¿”å›ï¼š**
```javascript
{
  compressed: true,
  messages: [...],           // å‹ç¼©åçš„æ¶ˆæ¯
  summary: 'æ—©æœŸè®¨è®ºæ‘˜è¦...',  // å‹ç¼©çš„æ‘˜è¦
  stats: {...},
  savedTokens: 12000         // èŠ‚çœçš„ Token æ•°
}
```

---

#### ğŸ†• Token é¢„ç®—æ§åˆ¶
```javascript
await setTokenBudget(discussionId, 100000)
const budget = await checkTokenBudget(discussionId)
```

**è¿”å›ï¼š**
```javascript
{
  used: 45000,
  budget: 100000,
  remaining: 55000,
  percentage: 45,
  exceeded: false,
  warning: false  // è¶…è¿‡ 80% æ—¶ä¸º true
}
```

---

#### ğŸ†• è‡ªåŠ¨å‹ç¼©
**åŠŸèƒ½ï¼š**
- æ¯æ¬¡ `agentSpeak()` åæ£€æŸ¥ Token ä½¿ç”¨é‡
- è¶…è¿‡ 80,000 tokens æ—¶è‡ªåŠ¨è§¦å‘å‹ç¼©
- è®°å½•å‹ç¼©å†å²

**é…ç½®ï¼š**
```javascript
{
  compressThreshold: 80000,  // å‹ç¼©é˜ˆå€¼
  maxTokens: 130000,         // ç¡¬é™åˆ¶
  keepRecent: 50             // ä¿ç•™æœ€è¿‘æ¶ˆæ¯æ•°
}
```

---

#### ğŸ†• å‹ç¼©å»ºè®®
```javascript
const suggestions = await getCompressionSuggestions(discussionId)
```

**è¿”å›ï¼š**
```javascript
{
  needed: true,
  urgency: 'warning',  // warning | critical
  reason: 'Token ä½¿ç”¨é‡ 85000 å·²æ¥è¿‘é™åˆ¶ 130000',
  suggestion: 'å»ºè®®å‹ç¼©ä¸Šä¸‹æ–‡ï¼Œé¢„è®¡å¯èŠ‚çœ ~12000 tokens',
  savedTokens: 12000
}
```

---

## 3ï¸âƒ£ æ™ºèƒ½æ ‡è®°ç³»ç»Ÿï¼ˆ5 ä¸ªï¼‰â­â­â­

### æ–°å¢åŠŸèƒ½ï¼ˆ5 ä¸ªï¼‰

#### ğŸ†• æ·»åŠ æ ‡è®°
```javascript
await addMarker(discussionId, {
  title: 'é‡è¦å†³ç­–',
  type: 'decision',      // milestone | decision | problem | solution
  messageId: 'msg-123',
  summary: 'å†³å®šé‡‡ç”¨å¾®æœåŠ¡æ¶æ„',
  conclusions: [
    'ä½¿ç”¨å¾®æœåŠ¡æ¶æ„',
    'é‡‡ç”¨åˆ†å±‚è®¾è®¡'
  ],
  tags: ['æ¶æ„', 'å†³ç­–']
})
```

**4 ç§æ ‡è®°ç±»å‹ï¼š**
- ğŸ† **é‡Œç¨‹ç¢‘** (milestone) - é‡è¦èŠ‚ç‚¹
- ğŸ¯ **å†³ç­–** (decision) - å…³é”®å†³ç­–
- âš ï¸ **é—®é¢˜** (problem) - å‘ç°çš„é—®é¢˜
- ğŸ’¡ **æ–¹æ¡ˆ** (solution) - è§£å†³æ–¹æ¡ˆ

---

#### ğŸ†• è·å–æ ‡è®°
```javascript
const markers = await getMarkers(discussionId)
```

**è¿”å›ï¼š**
```javascript
[
  {
    id: 'marker-1',
    title: 'é‡è¦å†³ç­–',
    type: 'decision',
    summary: '...',
    conclusions: [...],
    tags: [...],
    timestamp: 1735857600000
  },
  ...
]
```

---

#### ğŸ†• è‡ªåŠ¨æ£€æµ‹æ ‡è®° â­â­â­
```javascript
const detected = await detectAndAddMarkers(discussionId, {
  maxMarkers: 5,
  minConfidence: 0.7
})
```

**åŠŸèƒ½ï¼š**
- AI è‡ªåŠ¨æ£€æµ‹é‡è¦æ—¶åˆ»
- åˆ†ææ¶ˆæ¯å†…å®¹
- è‡ªåŠ¨ç”Ÿæˆæ ‡è®°å»ºè®®

---

#### ğŸ†• æ™ºèƒ½æ‘˜è¦
```javascript
const summary = await generateSmartSummary(discussionId)
```

**åŠŸèƒ½ï¼š**
- åŸºäºæ ‡è®°ç”Ÿæˆè®¨è®ºæ€»ç»“
- æå–å…³é”®ç»“è®º
- æŒ‰æ—¶é—´çº¿ç»„ç»‡

---

#### ğŸ†• è®¨è®ºé˜¶æ®µæ£€æµ‹
```javascript
const phase = await detectDiscussionPhase(discussionId)
```

**è¿”å›ï¼š**
```javascript
'initializing' | 'discussing' | 'deciding' | 'concluding' | 'milestone_reached'
```

---

## 4ï¸âƒ£ æ ‡ç­¾ç³»ç»Ÿï¼ˆ6 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ6 ä¸ªï¼‰

#### ğŸ†• æ·»åŠ æ ‡ç­¾
```javascript
await addTagToDiscussion(discussionId, 'é«˜ä¼˜å…ˆçº§')
```

#### ğŸ†• ç§»é™¤æ ‡ç­¾
```javascript
await removeTagFromDiscussion(discussionId, 'ä½ä¼˜å…ˆçº§')
```

#### ğŸ†• è·å–è®¨è®ºæ ‡ç­¾
```javascript
const tags = await getDiscussionTags(discussionId)
// è¿”å›: ['é«˜ä¼˜å…ˆçº§', 'å‰ç«¯', 'é‡è¦']
```

#### ğŸ†• è·å–æ‰€æœ‰æ ‡ç­¾
```javascript
const allTags = await getAllTags()
```

**è¿”å›ï¼š**
```javascript
[
  { tag: 'é«˜ä¼˜å…ˆçº§', count: 15 },
  { tag: 'å‰ç«¯', count: 8 },
  { tag: 'é‡è¦', count: 20 }
]
```

#### ğŸ†• æŒ‰æ ‡ç­¾æœç´¢
```javascript
const discussions = await findDiscussionsByTag('é«˜ä¼˜å…ˆçº§')
```

#### ğŸ†• æ·»åŠ æ ‡ç­¾ï¼ˆå®ä¾‹æ–¹æ³•ï¼‰
```javascript
// åœ¨ DiscussionContext ä¸­
discussion.addTag('ç´§æ€¥')
discussion.removeTag('ç´§æ€¥')
discussion.hasTag('ç´§æ€¥')  // true/false
discussion.getTags()       // ['ç´§æ€¥', 'é‡è¦']
```

---

## 5ï¸âƒ£ å½’æ¡£ç®¡ç†ï¼ˆ5 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ5 ä¸ªï¼‰

#### ğŸ†• å½’æ¡£è®¨è®º
```javascript
await archiveDiscussion(discussionId)
```

**åŠŸèƒ½ï¼š**
- å°†è®¨è®ºæ ‡è®°ä¸ºå·²å½’æ¡£
- ä¸åœ¨æ´»è·ƒåˆ—è¡¨æ˜¾ç¤º
- æ•°æ®ä¿ç•™ï¼Œå¯æ¢å¤

---

#### ğŸ†• å–æ¶ˆå½’æ¡£
```javascript
await unarchiveDiscussion(discussionId)
```

#### ğŸ†• è·å–å·²å½’æ¡£è®¨è®º
```javascript
const archived = await getArchivedDiscussions()
```

#### ğŸ†• è·å–æ´»è·ƒè®¨è®º
```javascript
const active = await getActiveDiscussions()
```
**è¯´æ˜ï¼š** è¿”å› status='active' çš„è®¨è®ºï¼ˆæ’é™¤ archived å’Œ endedï¼‰

#### ğŸ†• è·å–å·²å®Œæˆè®¨è®º
```javascript
const completed = await getCompletedDiscussions()
```

**çŠ¶æ€æšä¸¾ï¼š**
```javascript
'active'     // è¿›è¡Œä¸­
'ended'      // å·²ç»“æŸ
'archived'   // å·²å½’æ¡£
```

---

## 6ï¸âƒ£ å¯¼å‡ºåˆ†äº«ï¼ˆ4 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ1 ä¸ªï¼‰

#### ğŸ†• æ‰¹é‡å¯¼å‡º
```javascript
const results = await exportAllDiscussions('markdown')
```

**è¿”å›ï¼š**
```javascript
[
  {
    discussionId: 'disc-1',
    format: 'markdown',
    path: '/exports/discussion-1-2026-02-03.md',
    size: 15432
  },
  ...
]
```

---

### æ”¹è¿›åŠŸèƒ½ï¼ˆ2 ä¸ªï¼‰

#### ğŸ”§ å¯¼å‡ºè®¨è®ºï¼ˆå¢å¼ºï¼‰
```javascript
await exportDiscussion(discussionId, 'markdown')
```

**Markdown åŒ…å«ï¼š**
- ğŸ“Œ æ ‡é¢˜ã€ç±»åˆ«ã€çŠ¶æ€ã€æ—¶é—´
- ğŸ·ï¸ æ ‡ç­¾
- ğŸ‘¥ å‚ä¸è€…
- ğŸ“Š ç»Ÿè®¡ï¼ˆæ¶ˆæ¯ã€æ ‡è®°ã€Tokenã€è¿›åº¦ï¼‰
- ğŸ“ æ ‡è®°æ—¶é—´è½´
- ğŸ’¬ æ¶ˆæ¯æµ

---

#### ğŸ”§ JSON å¯¼å‡ºï¼ˆå¢å¼ºï¼‰
```javascript
await exportDiscussion(discussionId, 'json')
```

**JSON åŒ…å«ï¼š**
- å®Œæ•´çš„è®¨è®ºæ•°æ®
- æ‰€æœ‰æ ‡è®°
- Token å†å²
- å¯ç”¨äºå¤‡ä»½å’Œè¿ç§»

---

### ä¿ç•™åŠŸèƒ½ï¼ˆ1 ä¸ªï¼‰

```javascript
âœ… å¯¼å‡ºä¸ºæ–‡ä»¶ï¼ˆå·²æœ‰ï¼‰
```

---

## 7ï¸âƒ£ æœç´¢ç»Ÿè®¡ï¼ˆ8 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ4 ä¸ªï¼‰

#### ğŸ†• å…¨å±€ç»Ÿè®¡ï¼ˆå¢å¼ºï¼‰
```javascript
const stats = await getStatistics()
```

**è¿”å›ï¼š**
```javascript
{
  total: 108,              // æ€»è®¨è®ºæ•°
  byStatus: {
    active: 45,
    ended: 38,
    archived: 25
  },
  byCategory: {
    'éœ€æ±‚è®¨è®º': 20,
    'åŠŸèƒ½ç ”å‘': 35,
    'åŠŸèƒ½æµ‹è¯•': 18,
    'æ–‡æ¡£ç¼–å†™': 35
  },
  totalMessages: 1250,
  totalMarkers: 156,
  totalTokens: 4560000,   // ğŸ†• Token æ€»é‡
  totalParticipants: 580,
  activeProjects: 12       // æœ€è¿‘ 24 å°æ—¶æ´»è·ƒ
}
```

---

#### ğŸ†• æŒ‰ç±»åˆ«åˆ†ç»„
```javascript
const grouped = await getDiscussionsByCategory()
```

**è¿”å›ï¼š**
```javascript
{
  'éœ€æ±‚è®¨è®º': [discussion1, discussion2],
  'åŠŸèƒ½ç ”å‘': [discussion3, discussion4],
  ...
}
```

---

#### ğŸ†• è®¨è®ºè¯¦æƒ…ï¼ˆå¢å¼ºï¼‰
```javascript
const discussion = await getDiscussion(discussionId)
```

**æ–°å¢å­—æ®µï¼š**
```javascript
{
  ...åŸæœ‰å­—æ®µ,
  category: 'åŠŸèƒ½ç ”å‘',      // ğŸ†• ç±»åˆ«
  tags: ['é«˜ä¼˜å…ˆçº§'],        // ğŸ†• æ ‡ç­¾
  notes: 'å¤‡æ³¨å†…å®¹',         // ğŸ†• å¤‡æ³¨
  priority: 'high',          // ğŸ†• ä¼˜å…ˆçº§
  markers: [...],            // ğŸ†• æ ‡è®°
  stats: {
    totalMarkers: 5,         // ğŸ†• æ ‡è®°æ•°
    totalTokens: 45000,      // ğŸ†• Token æ€»é‡
    progress: 60             // ğŸ†• è¿›åº¦
  }
}
```

---

#### ğŸ†• æœç´¢è®¨è®ºï¼ˆå¢å¼ºï¼‰
```javascript
const results = await searchDiscussions('å¾®æœåŠ¡', {
  category: 'åŠŸèƒ½ç ”å‘',  // ğŸ†• æŒ‰ç±»åˆ«æœç´¢
  tags: ['æ¶æ„'],        // ğŸ†• æŒ‰æ ‡ç­¾æœç´¢
  limit: 10
})
```

**æ–°å¢æœç´¢å­—æ®µï¼š**
- ç±»åˆ«ï¼ˆcategoryï¼‰
- æ ‡ç­¾ï¼ˆtagsï¼‰
- æ ‡è®°å†…å®¹ï¼ˆmarkersï¼‰
- Token ç»Ÿè®¡

---

### æ”¹è¿›åŠŸèƒ½ï¼ˆ2 ä¸ªï¼‰

#### ğŸ”§ å…¨å±€æœç´¢ï¼ˆå¢å¼ºï¼‰
```javascript
await search('å…³é”®è¯')
```
**æœç´¢èŒƒå›´æ‰©å¤§ï¼š**
- è®¨è®ºä¸»é¢˜ã€æè¿°
- æ¶ˆæ¯å†…å®¹
- æ ‡è®°æ ‡é¢˜ã€æ‘˜è¦
- æ ‡ç­¾

---

#### ğŸ”§ ç›¸ä¼¼è®¨è®ºï¼ˆä¿ç•™ï¼‰
```javascript
await findSimilarDiscussions(discussionId, 0.3, 10)
```

---

### ä¿ç•™åŠŸèƒ½ï¼ˆ2 ä¸ªï¼‰

```javascript
âœ… æœç´¢å†å²
âœ… çƒ­é—¨å…³é”®è¯
```

---

## 8ï¸âƒ£ å¤‡æ³¨åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰â­

### æ–°å¢åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰

#### ğŸ†• è®¾ç½®å¤‡æ³¨
```javascript
await setDiscussionNotes(discussionId, 'è¿™æ˜¯é‡è¦çš„è®¨è®º')
```

#### ğŸ†• è¿½åŠ å¤‡æ³¨
```javascript
await appendDiscussionNotes(discussionId, 'å·²å®Œæˆç¬¬ä¸€é˜¶æ®µ')
```

**è‡ªåŠ¨æ·»åŠ æ—¶é—´æˆ³ï¼š**
```
--- 2026-02-03 16:00:00 ---
å·²å®Œæˆç¬¬ä¸€é˜¶æ®µ
```

#### ğŸ†• è·å–å¤‡æ³¨
```javascript
const notes = await getDiscussionNotes(discussionId)
```

---

## 9ï¸âƒ£ å…‹éš†åŠŸèƒ½ï¼ˆ1 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ1 ä¸ªï¼‰

#### ğŸ†• å…‹éš†è®¨è®º
```javascript
const cloned = await cloneDiscussion(discussionId, 'æ–°è®¨è®ºåç§°')
```

**åŠŸèƒ½ï¼š**
- åŸºäºç°æœ‰è®¨è®ºåˆ›å»ºå‰¯æœ¬
- ä¿ç•™ï¼šç±»åˆ«ã€æ ‡ç­¾ã€å‚ä¸è€…ã€æè¿°
- æ¸…ç©ºï¼šæ¶ˆæ¯ã€æ ‡è®°ã€ç»Ÿè®¡æ•°æ®
- è‡ªåŠ¨è®¾ç½®çŠ¶æ€ä¸º active

---

## ğŸ”Ÿ ä¼˜å…ˆçº§ç³»ç»Ÿï¼ˆ3 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰

#### ğŸ†• è®¾ç½®ä¼˜å…ˆçº§
```javascript
await setPriority(discussionId, 'high')
```

**4 çº§ä¼˜å…ˆçº§ï¼š**
- `low` - ä½
- `medium` - ä¸­ï¼ˆé»˜è®¤ï¼‰
- `high` - é«˜
- `critical` - ç´§æ€¥

#### ğŸ†• è·å–ä¼˜å…ˆçº§
```javascript
const priority = await getPriority(discussionId)
// è¿”å›: 'high'
```

#### ğŸ†• æŒ‰ä¼˜å…ˆçº§æ’åº
```javascript
const discussions = await listDiscussions({
  sortBy: 'priority'  // low â†’ medium â†’ high â†’ critical
})
```

---

## 1ï¸âƒ£1ï¸âƒ£ Agent æ€§èƒ½åˆ†æï¼ˆ3 ä¸ªï¼‰

### ä¿ç•™åŠŸèƒ½ï¼ˆ3 ä¸ªï¼‰

```javascript
âœ… analyzeAgentPerformance(discussionId)  // åˆ†ææ€§èƒ½
âœ… getAgentLeaderboard(limit)             // æ’è¡Œæ¦œ
âœ… compareAgents(agentId1, agentId2)      // å¯¹æ¯”
```

---

## 1ï¸âƒ£2ï¸âƒ£ è´¨é‡è¯„åˆ†ï¼ˆ4 ä¸ªï¼‰

### ä¿ç•™åŠŸèƒ½ï¼ˆ4 ä¸ªï¼‰

```javascript
âœ… calculateQualityScore(discussionId)  // è´¨é‡åˆ†æ•°
âœ… startRealtimeScoring(discussionId)   // å®æ—¶è¯„åˆ†
âœ… getScoreHistory(discussionId)        // è¯„åˆ†å†å²
âœ… getScoreRadarData(discussionId)      // é›·è¾¾å›¾æ•°æ®
```

---

## 1ï¸âƒ£3ï¸âƒ£ æ™ºèƒ½å»ºè®®ï¼ˆ4 ä¸ªï¼‰

### ä¿ç•™åŠŸèƒ½ï¼ˆ4 ä¸ªï¼‰

```javascript
âœ… generateSuggestions(discussionId, options)
âœ… dismissSuggestion(discussionId, suggestionId)
âœ… applySuggestion(discussionId, suggestionId)
âœ… getSuggestionStats(discussionId)
```

---

## 1ï¸âƒ£4ï¸âƒ£ æ¨¡æ¿ç³»ç»Ÿï¼ˆ5 ä¸ªï¼‰

### ä¿ç•™åŠŸèƒ½ï¼ˆ5 ä¸ªï¼‰

```javascript
âœ… getTemplates()                      // è·å–æ¨¡æ¿
âœ… getTemplate(templateId)             // è·å–å•ä¸ªæ¨¡æ¿
âœ… createDiscussionFromTemplate(...)   // ä»æ¨¡æ¿åˆ›å»º
âœ… createUserTemplate(name, config)    // åˆ›å»ºè‡ªå®šä¹‰æ¨¡æ¿
âœ… searchTemplates(query)              // æœç´¢æ¨¡æ¿
```

---

## 1ï¸âƒ£5ï¸âƒ£ å…¶ä»–åŠŸèƒ½ï¼ˆ10 ä¸ªï¼‰

### æ–°å¢åŠŸèƒ½ï¼ˆ2 ä¸ªï¼‰

#### ğŸ†• æ›´æ–°è®¨è®º
```javascript
await updateDiscussion(discussionId, {
  topic: 'æ–°ä¸»é¢˜',
  description: 'æ–°æè¿°',
  priority: 'high'
})
```

#### ğŸ†• è·å–å‹ç¼©çŠ¶æ€
```javascript
const status = await getCompressionStatus(discussionId)
```

---

### ä¿ç•™åŠŸèƒ½ï¼ˆ8 ä¸ªï¼‰

```javascript
âœ… ç¼“å­˜ç®¡ç†ï¼ˆclearCache, getCacheStatsï¼‰
âœ… å¿«ç…§ä¸å¯¹æ¯”
âœ… å†²çªä¸å…±è¯†
âœ… æåŠä¸å¼•ç”¨
âœ… å‚ä¸è€…ç®¡ç†
âœ… ç›¸ä¼¼åº¦æ£€æµ‹
âœ… æ¶ˆæ¯åˆ†é¡µ
âœ… å­˜å‚¨ç»Ÿè®¡
```

---

## ğŸ“¡ API è·¯ç”±æ€»è§ˆ

### è®¨è®ºç®¡ç†
```
POST   /api/discussion                      åˆ›å»ºè®¨è®º
GET    /api/discussions                     åˆ—å‡ºè®¨è®º
GET    /api/discussion/:id                  è·å–è®¨è®º
PUT    /api/discussion/:id                  æ›´æ–°è®¨è®º
DELETE /api/discussion/:id                  åˆ é™¤è®¨è®º
POST   /api/discussion/:id/end              ç»“æŸè®¨è®º
```

### Token ç®¡ç†
```
GET    /api/discussion/:id/tokens           Token ç»Ÿè®¡
GET    /api/discussion/:id/tokens/history   Token å†å²
POST   /api/discussion/:id/compress         æ‰‹åŠ¨å‹ç¼©
GET    /api/discussion/:id/compression-status å‹ç¼©çŠ¶æ€
POST   /api/discussion/:id/budget           è®¾ç½®é¢„ç®—
GET    /api/discussion/:id/budget-status    é¢„ç®—çŠ¶æ€
```

### æ™ºèƒ½æ ‡è®°
```
GET    /api/discussion/:id/markers          è·å–æ ‡è®°
POST   /api/discussion/:id/marker           æ·»åŠ æ ‡è®°
POST   /api/discussion/:id/markers/generate è‡ªåŠ¨ç”Ÿæˆæ ‡è®°
GET    /api/discussion/:id/summary          æ™ºèƒ½æ‘˜è¦
GET    /api/discussion/:id/phase            è®¨è®ºé˜¶æ®µ
```

### æ ‡ç­¾ç³»ç»Ÿ
```
GET    /api/discussion/:id/tags             è·å–æ ‡ç­¾
POST   /api/discussion/:id/tags             æ·»åŠ æ ‡ç­¾
DELETE /api/discussion/:id/tags/:tag        åˆ é™¤æ ‡ç­¾
GET    /api/tags                            æ‰€æœ‰æ ‡ç­¾
GET    /api/discussions/by-tag/:tag         æŒ‰æ ‡ç­¾æœç´¢
```

### å½’æ¡£ç®¡ç†
```
POST   /api/discussion/:id/archive          å½’æ¡£
POST   /api/discussion/:id/unarchive        å–æ¶ˆå½’æ¡£
GET    /api/discussions/archived            å·²å½’æ¡£åˆ—è¡¨
GET    /api/discussions/active              æ´»è·ƒåˆ—è¡¨
GET    /api/discussions/completed           å·²å®Œæˆåˆ—è¡¨
```

### å¯¼å‡ºåˆ†äº«
```
GET    /api/discussion/:id/export           å¯¼å‡ºè®¨è®º
GET    /api/export/all                      æ‰¹é‡å¯¼å‡º
POST   /api/discussion/:id/clone            å…‹éš†è®¨è®º
```

### å¤‡æ³¨åŠŸèƒ½
```
GET    /api/discussion/:id/notes            è·å–å¤‡æ³¨
PUT    /api/discussion/:id/notes            è®¾ç½®å¤‡æ³¨
POST   /api/discussion/:id/notes/append     è¿½åŠ å¤‡æ³¨
```

### å…¶ä»–
```
GET    /api/discussions/by-category/:category  æŒ‰ç±»åˆ«
GET    /api/statistics                         å…¨å±€ç»Ÿè®¡
POST   /api/discussion/:id/priority            è®¾ç½®ä¼˜å…ˆçº§
...
```

---

## ğŸ¯ æ•°æ®æ¨¡å‹ï¼šDiscussion

```javascript
class DiscussionContext {
  constructor(id, topic, participants) {
    // ========== åŸæœ‰å­—æ®µ ==========
    this.id = id;
    this.topic = topic;
    this.participants = participants;
    this.messages = [];
    this.status = 'initializing';
    this.createdAt = Date.now();
    this.updatedAt = Date.now();
    this.rounds = 0;
    this.conflicts = [];
    this.consensus = new Map();
    this.agentStates = new Map();

    // ========== v3.7.0 æ–°å¢å­—æ®µ ==========

    // ç±»åˆ«ä¸æè¿°
    this.category = null;              // ğŸ†• ç±»åˆ«
    this.description = '';             // ğŸ†• æè¿°

    // æ™ºèƒ½æ ‡è®°
    this.markers = [];                 // ğŸ†• æ ‡è®°æ•°ç»„

    // æ ‡ç­¾ç³»ç»Ÿ
    this.tags = [];                    // ğŸ†• æ ‡ç­¾

    // å¤‡æ³¨ä¸ä¼˜å…ˆçº§
    this.notes = '';                   // ğŸ†• å¤‡æ³¨
    this.priority = 'medium';          // ğŸ†• ä¼˜å…ˆçº§

    // Token ç»Ÿè®¡
    this.totalTokens = 0;              // ğŸ†• æ€» Token
    this.inputTokens = 0;              // ğŸ†• è¾“å…¥ Token
    this.outputTokens = 0;             // ğŸ†• è¾“å‡º Token
    this.tokenHistory = [];            // ğŸ†• Token å†å²

    // å¢å¼ºç»Ÿè®¡
    this.stats = {
      totalMessages: 0,
      totalMarkers: 0,        // ğŸ†• æ ‡è®°æ•°
      totalTokens: 0,         // ğŸ†• Token æ€»é‡
      progress: 0,            // ğŸ†• è¿›åº¦
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
  }

  // ========== v3.7.0 æ–°å¢æ–¹æ³• ==========

  // æ ‡è®°ç®¡ç†
  addMarker(marker) { ... }
  getMarkers() { ... }

  // æ ‡ç­¾ç®¡ç†
  addTag(tag) { ... }
  removeTag(tag) { ... }
  hasTag(tag) { ... }
  getTags() { ... }

  // å¤‡æ³¨ç®¡ç†
  setNotes(notes) { ... }
  getNotes() { ... }
  appendNotes(text) { ... }

  // ä¼˜å…ˆçº§ç®¡ç†
  setPriority(priority) { ... }
  getPriority() { ... }
  getPriorityValue() { ... }

  // Token ç®¡ç†
  getTokenStats() { ... }
  getTokenHistory() { ... }
  updateTokenCount(tokens) { ... }
}
```

---

## âœ… å‘åå…¼å®¹æ€§

### v3.6.x æ•°æ®è¿ç§»

**è‡ªåŠ¨è¿ç§»ï¼š**
```bash
data/projects/group-xxx/project.json
    â†“ è‡ªåŠ¨è½¬æ¢
data/discussions/group-xxx.json
```

**å­—æ®µæ˜ å°„ï¼š**
```javascript
{
  name â†’ topic,              // åç§° â†’ ä¸»é¢˜
  category â†’ category,        // ä¿ç•™
  markers â†’ markers,          // ä¿ç•™
  tags â†’ tags,               // ä¿ç•™
  notes â†’ notes,             // ä¿ç•™
  priority â†’ priority,       // ä¿ç•™
  totalTokens â†’ totalTokens  // ä¿ç•™
}
```

### API å…¼å®¹æ€§

**ä¿ç•™çš„ APIï¼š**
- æ‰€æœ‰ v3.6.x çš„ API è·¯ç”±ä¿æŒä¸å˜
- æ–°å¢å­—æ®µå‘ä¸‹å…¼å®¹ï¼ˆæ—§æ•°æ®ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼‰

---

## ğŸ“Š å¼€å‘æ£€æŸ¥æ¸…å•

### æ•°æ®æ¨¡å‹
- [ ] DiscussionContext æ·»åŠ  14 ä¸ªæ–°å­—æ®µ
- [ ] DiscussionContext æ·»åŠ  11 ä¸ªå®ä¾‹æ–¹æ³•

### ç®¡ç†å™¨åŠŸèƒ½
- [ ] Token ç®¡ç†ï¼ˆ6 ä¸ªæ–¹æ³•ï¼‰
- [ ] æ™ºèƒ½æ ‡è®°ï¼ˆ5 ä¸ªæ–¹æ³•ï¼‰
- [ ] æ ‡ç­¾ç³»ç»Ÿï¼ˆ6 ä¸ªæ–¹æ³•ï¼‰
- [ ] å½’æ¡£åŠŸèƒ½ï¼ˆ5 ä¸ªæ–¹æ³•ï¼‰
- [ ] å¯¼å‡ºåŠŸèƒ½ï¼ˆ1 ä¸ªæ–¹æ³•ï¼‰
- [ ] å¤‡æ³¨åŠŸèƒ½ï¼ˆ3 ä¸ªæ–¹æ³•ï¼‰
- [ ] å…‹éš†åŠŸèƒ½ï¼ˆ1 ä¸ªæ–¹æ³•ï¼‰
- [ ] ä¼˜å…ˆçº§ï¼ˆ3 ä¸ªæ–¹æ³•ï¼‰
- [ ] ç±»åˆ«ç³»ç»Ÿï¼ˆ1 ä¸ªæ–¹æ³•ï¼‰
- [ ] è‡ªç„¶è¯­è¨€åˆ›å»ºï¼ˆ1 ä¸ªæ–¹æ³•ï¼‰

### æ•°æ®è¿ç§»
- [ ] è¿ç§»è„šæœ¬ï¼šdata/projects â†’ data/discussions
- [ ] è¿ç§» 108 ä¸ªé¡¹ç›®æ•°æ®
- [ ] éªŒè¯æ•°æ®å®Œæ•´æ€§

### æ–‡ä»¶æ¸…ç†
- [ ] åˆ é™¤ src/models/project-group.js
- [ ] åˆ é™¤ src/core/project-manager.js
- [ ] åˆ é™¤ src/core/project-flow.js
- [ ] åˆ é™¤ src/v3-integration.js
- [ ] åˆ é™¤ data/projects/

### æµ‹è¯•
- [ ] æ‰€æœ‰ç°æœ‰æµ‹è¯•é€šè¿‡
- [ ] æ–°å¢ Token åŠŸèƒ½æµ‹è¯•
- [ ] æ–°å¢æ ‡è®°åŠŸèƒ½æµ‹è¯•
- [ ] æ–°å¢æ ‡ç­¾åŠŸèƒ½æµ‹è¯•
- [ ] æ–°å¢å½’æ¡£åŠŸèƒ½æµ‹è¯•

### æ–‡æ¡£
- [ ] æ›´æ–° README.md
- [ ] æ›´æ–° CHANGELOG.md
- [ ] æ·»åŠ  Token åŠŸèƒ½æ–‡æ¡£
- [ ] æ·»åŠ æ ‡è®°åŠŸèƒ½æ–‡æ¡£
- [ ] æ›´æ–° API æ–‡æ¡£

---

## ğŸ‰ ç‰ˆæœ¬äº®ç‚¹

### â­ æ ¸å¿ƒäº®ç‚¹

1. **æ¦‚å¿µç»Ÿä¸€** - åªæœ‰ä¸€ä¸ª"è®¨è®ºç»„"æ¦‚å¿µï¼Œä¸å†æ··æ·†
2. **Token æ™ºèƒ½ç®¡ç†** - è‡ªåŠ¨ç»Ÿè®¡ã€è‡ªåŠ¨å‹ç¼©ã€é¢„ç®—æ§åˆ¶
3. **æ™ºèƒ½æ ‡è®°** - AI è‡ªåŠ¨æ£€æµ‹é‡è¦æ—¶åˆ»
4. **æ ‡ç­¾ç³»ç»Ÿ** - ä¾¿äºç»„ç»‡å’Œç®¡ç†è®¨è®º
5. **å½’æ¡£åŠŸèƒ½** - ä¿æŒåˆ—è¡¨æ•´æ´

### ğŸ“ˆ æ•°é‡å¯¹æ¯”

| é¡¹ç›® | v3.6.x | v3.7.0 | å¢é•¿ |
|------|--------|--------|------|
| æ•°æ®å­—æ®µ | 8 | 22 | +175% |
| æ ¸å¿ƒæ–¹æ³• | ~40 | ~68 | +70% |
| API è·¯ç”± | ~40 | ~70 | +75% |

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**æœ€åæ›´æ–°ï¼š** 2026-02-03 08:15
**çŠ¶æ€ï¼š** âœ… åŠŸèƒ½æ¢³ç†å®Œæˆ
