<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MAD v4.0.10 - LLMæ™ºèƒ½è®¨è®º</title>
  <link rel="stylesheet" href="/style.css">
  <style>
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .version-badge {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 0.75rem;
      padding: 4px 12px;
      border-radius: 20px;
      margin-left: 10px;
    }

    .input-section {
      background: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    .topic-input {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 10px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      box-sizing: border-box;
      transition: all 0.3s;
    }

    .topic-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .mode-selector {
      margin: 20px 0;
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .mode-btn {
      padding: 10px 20px;
      border: 2px solid #e0e0e0;
      background: white;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      flex: 1;
    }

    .mode-btn.active {
      border-color: #667eea;
      background: #667eea;
      color: white;
    }

    .mode-btn:hover:not(.active) {
      border-color: #667eea;
    }

    .start-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .start-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .start-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .results-section {
      display: none;
    }

    .results-section.show {
      display: block;
    }

    .expert-card {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      margin-bottom: 20px;
      border-left: 5px solid #667eea;
    }

    .expert-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }

    .expert-name {
      font-size: 1.3rem;
      font-weight: bold;
      color: #333;
    }

    .expert-domain {
      margin-left: 15px;
      padding: 5px 12px;
      background: #f0f0f0;
      border-radius: 15px;
      font-size: 0.85rem;
      color: #666;
    }

    .expert-response {
      line-height: 1.8;
      color: #444;
      white-space: pre-wrap;
    }

    .loading {
      text-align: center;
      padding: 40px;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .info-box {
      background: #e3f2fd;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid #2196f3;
    }

    .info-box h3 {
      margin-top: 0;
      color: #1976d2;
    }

    .example-topics {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 20px;
    }

    .example-chip {
      padding: 8px 16px;
      background: #f5f5f5;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
      font-size: 0.9rem;
    }

    .example-chip:hover {
      background: #667eea;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ¦ MAD <span class="version-badge">v4.0.10</span></h1>
      <p style="color: #666; margin-top: 10px;">LLMæ™ºèƒ½è®¨è®ºç³»ç»Ÿ - çœŸå®AIä¸“å®¶åä½œ</p>
    </div>

    <div class="info-box">
      <h3>âœ¨ v4.0.8é‡å¤§æ›´æ–°</h3>
      <p><strong>çœŸå®LLMé›†æˆ</strong>ï¼šä¸“å®¶ç°åœ¨ä½¿ç”¨çœŸæ­£çš„LLMç”Ÿæˆå†…å®¹ï¼Œä¸å†æ˜¯æ¨¡æ¿å›å¤ï¼</p>
      <p><strong>æ³¨æ„</strong>ï¼šçœŸå®LLMåŠŸèƒ½éœ€è¦åœ¨OpenClaw Agentç¯å¢ƒä¸­è¿è¡Œã€‚Webç•Œé¢æä¾›æ¨¡æ‹Ÿæ¼”ç¤ºã€‚</p>
    </div>

    <div class="input-section">
      <h2 style="margin-top: 0;">ğŸ’¡ è¾“å…¥è®¨è®ºè¯é¢˜</h2>

      <textarea
        id="topicInput"
        class="topic-input"
        placeholder="ä¾‹å¦‚ï¼šæˆ‘æƒ³å¼€å‘ä¸€ä¸ªåœ¨çº¿æ•™è‚²å¹³å°ï¼Œéœ€è¦è€ƒè™‘æŠ€æœ¯æ¶æ„ã€ç”¨æˆ·ä½“éªŒå’Œå•†ä¸šæ¨¡å¼..."
      ></textarea>

      <div class="example-topics">
        <div class="example-chip" onclick="setTopic('æˆ‘æƒ³å¼€å‘ä¸€ä¸ªåœ¨çº¿æ•™è‚²å¹³å°')">åœ¨çº¿æ•™è‚²å¹³å°</div>
        <div class="example-chip" onclick="setTopic('å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜å¹¶å‘çš„èŠå¤©ç³»ç»Ÿ')">é«˜å¹¶å‘èŠå¤©ç³»ç»Ÿ</div>
        <div class="example-chip" onclick="setTopic('ç”µå•†ç³»ç»Ÿçš„ç§’æ€åŠŸèƒ½å¦‚ä½•è®¾è®¡')">ç§’æ€ç³»ç»Ÿè®¾è®¡</div>
        <div class="example-chip" onclick="setTopic('SaaSäº§å“çš„å•†ä¸šæ¨¡å¼å’Œå®šä»·ç­–ç•¥')">SaaSå•†ä¸šæ¨¡å¼</div>
      </div>

      <div class="mode-selector">
        <button class="mode-btn active" onclick="setMode('demo')">ğŸ­ æ¨¡æ‹Ÿæ¼”ç¤º</button>
        <button class="mode-btn" onclick="setMode('real')">ğŸ¤– çœŸå®LLMï¼ˆéœ€Agentç¯å¢ƒï¼‰</button>
      </div>

      <p id="modeHint" style="color: #666; font-size: 0.9rem; margin-bottom: 15px;">
        æ¨¡æ‹Ÿæ¨¡å¼ï¼šä½¿ç”¨é¢„è®¾å“åº”ï¼Œå¿«é€Ÿä½“éªŒåŠŸèƒ½
      </p>

      <button id="startBtn" class="start-btn" onclick="startDiscussion()">
        ğŸš€ å¼€å§‹è®¨è®º
      </button>
    </div>

    <div id="resultsSection" class="results-section">
      <div id="loading" class="loading" style="display: none;">
        <div class="spinner"></div>
        <p>ä¸“å®¶ä»¬æ­£åœ¨æ€è€ƒå’Œè®¨è®º...</p>
        <p style="color: #666; font-size: 0.9rem;">è¿™å¯èƒ½éœ€è¦10-30ç§’</p>
      </div>

      <div id="results"></div>
    </div>
  </div>

  <script>
    let currentMode = 'demo';

    function setMode(mode) {
      currentMode = mode;

      // æ›´æ–°æŒ‰é’®çŠ¶æ€
      document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');

      // æ›´æ–°æç¤º
      const hint = document.getElementById('modeHint');
      if (mode === 'demo') {
        hint.textContent = 'æ¨¡æ‹Ÿæ¨¡å¼ï¼šä½¿ç”¨é¢„è®¾å“åº”ï¼Œå¿«é€Ÿä½“éªŒåŠŸèƒ½';
      } else {
        hint.textContent = 'çœŸå®LLMæ¨¡å¼ï¼šéœ€è¦åœ¨OpenClaw Agentç¯å¢ƒä¸­è¿è¡Œï¼ˆæŸ¥çœ‹è¿”å›çš„ä»£ç ç¤ºä¾‹ï¼‰';
      }
    }

    function setTopic(topic) {
      document.getElementById('topicInput').value = topic;
    }

    async function startDiscussion() {
      const topic = document.getElementById('topicInput').value.trim();

      if (!topic) {
        alert('è¯·è¾“å…¥è®¨è®ºè¯é¢˜');
        return;
      }

      const startBtn = document.getElementById('startBtn');
      const resultsSection = document.getElementById('resultsSection');
      const loading = document.getElementById('loading');
      const results = document.getElementById('results');

      startBtn.disabled = true;
      startBtn.textContent = 'â³ è®¨è®ºä¸­...';
      resultsSection.classList.add('show');
      loading.style.display = 'block';
      results.innerHTML = '';

      try {
        const endpoint = currentMode === 'demo'
          ? '/api/v4/llm-discussion/demo'
          : '/api/v4/llm-discussion';

        const response = await fetch(endpoint, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ topic })
        });

        const data = await response.json();

        loading.style.display = 'none';

        if (data.status === 'info') {
          // çœŸå®LLMæ¨¡å¼ï¼Œæ˜¾ç¤ºè¯´æ˜
          results.innerHTML = `
            <div class="info-box">
              <h3>ğŸ“– å¦‚ä½•ä½¿ç”¨çœŸå®LLMåŠŸèƒ½</h3>
              <p>çœŸå®LLMè®¨è®ºéœ€è¦åœ¨OpenClaw Agentç¯å¢ƒä¸­è¿è¡Œã€‚è¯·åœ¨Agentä¸­ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š</p>
              <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">${data.instructions.code}</pre>
              <p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong></p>
              <ul>
                <li>WebæœåŠ¡å™¨ç¯å¢ƒæ— æ³•è®¿é—®OpenClawçš„tool.sessions_spawn</li>
                <li>çœŸå®LLMéœ€è¦é€šè¿‡sub-agentsè°ƒç”¨</li>
                <li>Agentç¯å¢ƒæä¾›å®Œæ•´çš„OpenClawèƒ½åŠ›</li>
              </ul>
              <p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼šæ‚¨å¯ä»¥ä½¿ç”¨"æ¨¡æ‹Ÿæ¼”ç¤º"æ¨¡å¼å¿«é€Ÿä½“éªŒåŠŸèƒ½ã€‚</p>
            </div>
          `;
        } else if (data.success) {
          // æ¨¡æ‹Ÿæ¨¡å¼æˆåŠŸ
          let html = '<h2 style="text-align: center;">ğŸ‰ è®¨è®ºç»“æœ</h2>';

          if (data.mode === 'demo') {
            html += `<p style="text-align: center; color: #666;">${data.note}</p>`;
          }

          data.experts.forEach(expert => {
            html += `
              <div class="expert-card">
                <div class="expert-header">
                  <span class="expert-name">${expert.name}</span>
                  <span class="expert-domain">${expert.domain}</span>
                </div>
                <div class="expert-response">${expert.response}</div>
              </div>
            `;
          });

          html += `
            <div class="info-box">
              <h3>ğŸ’¡ ä¸‹ä¸€æ­¥</h3>
              <p>æƒ³åœ¨çœŸå®é¡¹ç›®ä¸­ä½¿ç”¨LLMä¸“å®¶è®¨è®ºï¼Ÿåœ¨OpenClaw Agentä¸­è¿è¡Œï¼š</p>
              <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px;">const { DiscussionEngine } = require('./skills/MAD/src/core/v4/discussion-engine');

const engine = new DiscussionEngine({ tool: this.tool });
const result = await engine.startDiscussion({
  content: "ä½ çš„è¯é¢˜"
});

console.log(result.summary);</pre>
            </div>
          `;

          results.innerHTML = html;
        } else {
          results.innerHTML = `<p style="color: red;">é”™è¯¯ï¼š${data.error}</p>`;
        }

      } catch (error) {
        loading.style.display = 'none';
        results.innerHTML = `<p style="color: red;">è¯·æ±‚å¤±è´¥ï¼š${error.message}</p>`;
      }

      startBtn.disabled = false;
      startBtn.textContent = 'ğŸš€ å¼€å§‹è®¨è®º';
    }

    // å›è½¦å¿«æ·é”®
    document.getElementById('topicInput').addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        startDiscussion();
      }
    });
  </script>
</body>
</html>
